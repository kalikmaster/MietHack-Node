<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title1</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body{
            color: var(--tg-theme-text-color);
            background: var(--tg-theme-bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 18px;
        }

        textarea {
            resize: vertical;
            width: 100%;
            box-sizing: border-box;
        }

        .hint{
            color: var(--tg-theme-hint-color);
        }

        .link{
            color: var(--tg-theme-link-color);
        }

        .button{
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            font-size: 18px;
        }

        .button:not(:last-child){
            margin-bottom: 20px
        }
    </style>
</head>
<body id="body">
<form>
    <% form.forEach(function(field) { %>
        <% if (field.field_type == 'checkbox') { %>
            <fieldset>
                <legend><%= field.field_name %></legend>
                <% Object.values(field.field_values).forEach(function(box) { %>
                    <input type='checkbox' name='<%= field.field_id %>'><%= box %><br>
                <% }) %>
            </fieldset>
        <% } %>
        <% if (field.field_type == 'radiobox') { %>
            <fieldset>
                <legend><%= field.field_name %></legend>
                <% Object.values(field.field_values).forEach(function(box) { %>
                    <input type='radio' name='<%= field.field_id %>'><%= box %><br>
                <% }) %>
            </fieldset>
        <% } %>
        <% if (field.field_type == 'text') { %>
                <%= field.field_name %>
                <textarea name='<%= field.field_id %>' oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
            <br>
        <% } %>
        <% if (field.field_type == 'file') { %>
            <label><%= field.field_name %><input type="file" name='<%= field.field_id %>'></label>
            <br>
        <% } %>
        <br>
    <% }); %>
</form>
<script>
    let tg = Telegram.WebApp; //получаем объект webapp телеграма
    data = {
        initData: tg.initData
    }
    fetch('https://f5uhuv.deta.dev/validate', {
        method: "POST",
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    }).then(val => val.json()).then(val_json => {
            document.getElementById("body").innerHTML+=val_json.token
        }).catch(e => {
            document.getElementById("body").innerHTML+=e
        })
</script>
</body>
</html>